#! /usr/bin/python

# Author: Santhosh Balasubramanian
# Created: March 30, 2013
# Last Modified: March 30, 2013


# Library Imports
from pymongo import *


# getRefseqProteinForEnsembl: Returns Refseq Protein ID for Ensembl Gene ID.
def getRefseqProteinForEnsembl(ensemblID):
    # Open DB Connection
    cli = MongoClient()
    db = cli.db
    geneIDMap = db.geneIDMap
    uniprotDB = db.uniprotIDMap

    # Try Uniprot DB
    proteinRecord = uniprotDB.find_one( { 'ensembl_gene_id' : ensemblID } )

    if proteinRecord:
        return proteinRecord.get('refseq_protein_id')[0]
    else:
        # Get Entrez ID
        geneRecord = geneIDMap.find_one( { 'ensembl_gene_id' : ensemblID } )
        entrezID = geneRecord.get('entrez_gene_id')[0]
        proteinRecord = uniprotDB.find_one( { 'entrez_gene_id' : entrezID } )
        if proteinRecord:
            return proteinRecord.get('refseq_protein_id')[0]

    cli.close()
    return
    
